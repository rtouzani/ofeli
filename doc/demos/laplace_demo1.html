<!-- XHTML 1.0 Strict -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<meta name="author" content="Rachid Touzani" />
<meta name="keywords" content=" css, dropdowns, dropdown menu, drop-down, menu, navigation, nav, horizontal, vertical left-to-right, vertical right-to-left, horizontal linear, horizontal upwards, cross browser, internet explorer, ie, firefox, safari, opera, browser, lwis" />
<meta name="description" content="Clean, standards-friendly, modular framework for dropdown menus" />
<link href="../css/dropdown.vertical.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../css/default.ultimate.css" media="screen" rel="stylesheet" type="text/css" />

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>OFELI Demo: 2-D Laplace equation, P<sub>1</sub> Finite Element</title>
<link rel="stylesheet" type="text/css" href="../doxygen.css" />
<link rel="stylesheet" type="text/css" href="../tabs.css"  />
</head>

<body bgcolor="#FFFFFF" link="#FF0000" vlink="#FF00FF" alink="#FF00FF">
<p align="center"><a href="../index.html"><img src="../im/ofeli.gif" width="150" border="0"></a></p>

<center>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript"> 
     google.load('search', '1', {language : 'en', style : google.loader.themes.SHINY});
     google.setOnLoadCallback(function() {
        var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
        '012396140824982761142:-qrywxcfi_o', customSearchOptions);
        customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
        customSearchControl.draw('cse');
     }, true);
   </script>
   <style type="text/css">
     .gsc-control-cse {
     font-family: Verdana, sans-serif;
     border-color: #DAE0E5;
     background-color: #DAE0E5;
   }
   .gsc-control-cse .gsc-table-result { font-family: Verdana, sans-serif; }
   input.gsc-input { border-color: #B6BEC5; }
   input.gsc-search-button {
     border-color: #B6BEC5;
     background-color: #D0D1D4;
   }
   .gsc-tabHeader.gsc-tabhInactive {
     border-color: #999999;
     background-color: #EEEEEE;
   }
   .gsc-tabHeader.gsc-tabhActive {
     border-color: #999999;
     background-color: #999999;
   }
   .gsc-tabsArea { border-color: #999999; }
   .gsc-webResult.gsc-result,
   .gsc-results .gsc-imageResult {
     border-color: #FFFFFF;
     background-color: #FFFFFF;
   }
   .gsc-webResult.gsc-result:hover,
   .gsc-imageResult:hover {
     border-color: #D2D6DC;
     background-color: #EDEDED;
   }
   .gsc-webResult.gsc-result.gsc-promotion:hover {
     border-color: #D2D6DC;
     background-color: #EDEDED;
   }
   .gs-webResult.gs-result a.gs-title:link,
   .gs-webResult.gs-result a.gs-title:link b,
   .gs-imageResult a.gs-title:link,
   .gs-imageResult a.gs-title:link b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:visited,
   .gs-webResult.gs-result a.gs-title:visited b,
   .gs-imageResult a.gs-title:visited,
   .gs-imageResult a.gs-title:visited b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:hover,
   .gs-webResult.gs-result a.gs-title:hover b,
   .gs-imageResult a.gs-title:hover,
   .gs-imageResult a.gs-title:hover b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:active,
   .gs-webResult.gs-result a.gs-title:active b,
   .gs-imageResult a.gs-title:active,
   .gs-imageResult a.gs-title:active b { color: #0568CD; }
   .gsc-cursor-page { color: #0568CD; }
   a.gsc-trailing-more-results:link { color: #0568CD; }
   .gs-webResult .gs-snippet,
   .gs-imageResult .gs-snippet,
   .gs-fileFormatType { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl,
   .gs-imageResult div.gs-visibleUrl { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl-short { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl-short { display: none; }
   .gs-webResult div.gs-visibleUrl-long { display: block; }
   .gs-promotion div.gs-visibleUrl-short { display: none; }
   .gs-promotion div.gs-visibleUrl-long { display: block; }
   .gsc-cursor-box { border-color: #FFFFFF; }
   .gsc-results .gsc-cursor-box .gsc-cursor-page {
      border-color: #999999;
      background-color: #FFFFFF;
      color: #0568CD;
   }
   .gsc-results .gsc-cursor-box .gsc-cursor-current-page {
      border-color: #999999;
      background-color: #999999;
      color: #0568CD;
   }
   .gsc-webResult.gsc-result.gsc-promotion {
      border-color: #D2D6DC;
      background-color: #D0D1D4;
   }
   .gsc-completion-title { color: #0568CD; }
   .gsc-completion-snippet { color: #5F6A73; }
   .gs-promotion a.gs-title:link,
   .gs-promotion a.gs-title:link *,
   .gs-promotion .gs-snippet a:link { color: #0066CC; }
   .gs-promotion a.gs-title:visited,
   .gs-promotion a.gs-title:visited *,
   .gs-promotion .gs-snippet a:visited { color: #0066CC; }
   .gs-promotion a.gs-title:hover,
   .gs-promotion a.gs-title:hover *,
   .gs-promotion .gs-snippet a:hover { color: #0066CC; }
   .gs-promotion a.gs-title:active,
   .gs-promotion a.gs-title:active *,
   .gs-promotion .gs-snippet a:active { color: #0066CC; }
   .gs-promotion .gs-snippet,
   .gs-promotion .gs-title .gs-promotion-title-right,
   .gs-promotion .gs-title .gs-promotion-title-right *  { color: #333333; }
   .gs-promotion .gs-visibleUrl,
   .gs-promotion .gs-visibleUrl-short { color: #5F6A73; }
   </style>
</center>
</p>

<div id="mainmenu">
   <div class="text">
     <div class="tabs">
         <ul class="tablist">
           <li><a href="../index.html"><span>Home</span></a></li>
           <li><a href="../installation.html"><span>Installation</span></a></li>
           <li><a href="../html/index.html"><span>Class Documentation</span></a></li>
           <li><a href="../citing.html"><span>Citing OFELI</span></a></li>
           <li><a href="../fformats.html"><span>File Formats</span></a></li>
           <li class="current"><a href="../demos.html"><span>Demo Codes</span></a></li>
           <li><a href="../extlib.html"><span>External Libraries</span></a></li>
         </ul>
      </div>
   </div>
</div>

&nbsp;
<p><table border="2" cellpadding="2" cellspacing="0" >
<tr>
<td align="center" width="35"><a href="transport.html"><img src="../im/backward.gif" border="0"></a></td>
<td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
<td align="center" width="35"><a href="laplace_demo2.html"><img src="../im/forward.gif" border="0"></a></td>
</tr>
</table>

<p>
<h2>The 2-D Laplace equation: P<sub>1</sub> Finite Element</h2>

<p>
<SPAN class=TEXT>We present in this demo a more consistent use of the library. We aim at solving the basic
Laplace equation (more precisely the Poisson problem) in 2-D using P<sub>1</sub> finite elements.
</SPAN>

<ul type="square">
   <li><SPAN class=TEXT>As usual we start by including tha main <span class=LOGO>OFELI</span> head file.
   Next, since we aim at using the one of classes for the Laplace equation, we have to include the file
   <span class=TT>Laplace.h</span>.</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   #include "OFELI.h"
   #include "Laplace.h"
   using namespace OFELI;

   int main(int argc, char *argv[])
   {
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>The program has an argument the name of the the project file. If the
   argument is available, we instantiate the class <span class=TT>IPF</span> which manages
   project files.</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      if (argc &lt; 2) {
         cout &lt;&lt; "\nUsage: " &lt;&lt; argv[0] &lt;&lt; " &lt;project_file&gt;\n";
         return 0;
      }
      IPF data("laplace_demo1 - 1.0",argv[1]); 
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>As in every demo program we make use of exception handling to obtain clear error messages.
Next we assign to the <span class=LOGO>OFELI</span> global variable <span class=TT>Verbosity</span>
the value obtained from the project file.
</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      Verbosity = data.getVerbose();
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>The first essential task in the program consists in constructing the mesh using the mesh file.</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      Mesh ms(data.getMeshFile());</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We have now to set some data for the equation. Namely, the Dirichlet boundary condition and the source
term. They will be stored in dedicated files. To initialize them we make use of the class 
<span class=TT><a href="../html/classOFELI_1_1Prescription.html">Prescription</a></span> that helps prescribing
various data. This class reads these data from a <I>Prescription file</I>, which can be the project file itself.
The Dirichlet boundary conditions and the source are retrieved by member function <span class=TT>get</TT>.
</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      Vect&lt;double&gt; bc(ms), bf(ms);
      Prescription p(ms,data.getPrescriptionFile());
      p.get(BOUNDARY_CONDITION,bc);
      p.get(SOURCE,bf);
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We declare a vector that will contain the solution once the problem solved. Then we declare 
an instance of class <span class=TT><a href="../html/classOFELI_1_1Laplace2DT3.html">Laplace2DT3</a></span>
that handles the numerical solution of the Laplace equation in 2-D using P<sub>1</sub> finite elements
(3-Node triangles). We note that the constructor used the Mesh instance and the solution vector that will contain later the
solution.</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      Vect<double> u(ms);
      Laplace2DT3 eq(ms,u);
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>Now we can transmit to the equation class various prescribed data using membre function <span class=TT>setInput</span>:</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      eq.setInput(BOUNDARY_CONDITION,bc);
      eq.setInput(SOURCE,bf);
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>Once all data are transmitted, we can <I>run</I> (solve) the equation. The vector <span class=TT>u</span> contains
now the solution and can be solved in a file. For this end, we choose here the 
<span class=TT><a href="http://gmsh.info">Gmsh</a></span> <span class=TT>.pos</span> file.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      eq.run();
      saveField(u,"u.pos",GMSH);
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>To check the accuracy of the numerical solution, we have constructed an analytical solution of the equation.
This one is also defined via the <span class=TT><a href="../html/classOFELI_1_1Prescription.html">Prescription</a></span> class
and given as an algebraic expression in the project file. We can then compute the error norm as indicated in the source and
terminate the program.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      Vect&lt;double&gt; sol(ms);
      p.get(SOLUTION,sol);
      cout &lt;&lt; "L2-Error: " &lt;&lt; (u-sol).Norm(WNORM2) &lt;&lt; endl;
      return 0;
   }
</font></pre>
</td></tr></table></p>
</ul>

&nbsp;
<p><table align="center" border="2" cellpadding="2" cellspacing="0" >
<tr>
<td align="center" width="35"><a href="transport.html"><img src="../im/backward.gif" border="0"></a></td>
<td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
<td align="center" width="35"><a href="laplace_demo2.html"><img src="../im/forward.gif" border="0"></a></td>
</tr>
</table>

&nbsp;
<div id="foot_bar">
        Copyright &copy; 1998-2022 Rachid Touzani&nbsp;
</div>

</body>
</html>
