<!DOCTYPE HTML>
<html>
  <script src="http://www.w3schools.com/lib/w3data.js"></script>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="ofeli package" />
    <meta name="keywords" content="Modelling, numerical simulation, scientific computing, ofeli" />
    <title>ofeli library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <link rel="icon" type="image/png" sizes="10x10" href="../im/r.jpg" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-59742926-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="../im/ofeli.png">
    <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">

    <link rel="stylesheet" href="../doxygen.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/flexslider.css">
    <link rel="stylesheet" href="../fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/ofeli-style.css">
    <link rel="stylesheet" href="../css/doc.css">

<!--    Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
      <script src="js/respond.min.js"></script>
      <![endif]-->
  </head>

  <body>
    <div id="ofeli-page">
      <div class="container-wrap">
        <aside id="ofeli-aside" role="complementary" class="border js-fullheight">
          <div class="text-center">
            <a href="../index.html">
              <div class="logo-ofeli-img" style="background-image: url(../im/ofeli.png); background-size: 110%;"></div>
            </a>
            <span class="position"><b>Mathematical Modelling<br> and Numerical Simulation</b></span>
          </div>
          <div>
            <ul>
                <li class="active"><a href="../index.html">OFELI Documentation</a></li>
                <li class="active"><a href="../html/classes.html">Classes in OFELI</a></li>
                <li class="active"><a href="../fformats.html">File Formats</span></a></li>
                <li class="active"><a href="../extlib.html">External Libraries</span></a></li>
                <li class="active"><a href="../citing.html">Citing OFELI</span></a></li>
                <li class="active"><a href="../download.html">Download and Installation</a></li>
                <li class="active"><a href="../presentations.html">Presentations</a></li>
                <li class="active"><a href="../copyright.html">License</a></li>
                <li class="active"><a href="mailto:rachid.touzani@uca.fr">Contact</a></li>
            </ul>
        </div>

        <a href="rita.html"><center><img src="../im/rita.png" width="90"></center></a>

<!--      Search Google -->
          <center>
            <form method=GET action="http://www.google.com/search">
              <table bgcolor="#FFFFFF">
                <tr>
                  <td><a href=" http://www.google.com/">
                    <img src="http://www.google.com/logos/Logo_40wht.gif" border="0" alt="Google" align="absmiddle"></a> 
                    <input TYPE=TEXT name=q size=31 maxlength=255 value="">
                    <input type=hidden name=hl value="en">
                    <input type=submit name=btnG value="Search">
                  </td>
                </tr>
              </table>
            </form>
          </center>
 <!--     Search Google -->
 
          <div class="ofeli-footer">
            <p><small>&copy; Copyright <script>document.write(new Date().getFullYear());</script> All rights reserved</small>
            </p>
          </div>
        </aside>
        <div id="ofeli-main">
          <section class="ofeli-start" data-section="home">
            <div class="ofeli-narrow-content">
              <div class="row">
                <div class="col-md-12">
                  <div class="row row-bottom-padded-sm animate-box" data-animate-effect="fadeInLeft">
                    <div class="col-md-12">
                      <div class="start-desc">
                        <h1 class="first-ofeli-heading"></h1>
                        <div id="cc">
                          &nbsp;
                          <p>
                          <h2>Demo: Using an iterative solver for a PDE</h2>
                          
                          <p><table border="2" cellpadding="2" cellspacing="0" >
                          <tr>
                          <td align="center" width="35"><a href="ls_demo1.html"><img src="../im/backward.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="ode_demo1.html"><img src="../im/forward.gif" border="0"></a></td>
                          </tr>
                          </table></p>
                          
                          <p>
                          <SPAN class=TEXT>
                          In this example, we solve the Poisson equation (Laplace equation with
                          a right-hand side) by the P<sub>1</sub>-finite element method and by
                          using the Conjugate Gradient iterative method to solve the linear system.
                          </SPAN>
                          
                          <ul type=square>
                          <li><SPAN class=TEXT>As usual, we start by including the <span class=logo>OFELI</span>
                          principal header file and the header file dealing with the Laplace equation
                          and defining the namespace <span class=LOGO>OFELI</span>.
                          We start the program by reading the argument as the mesh file's name. Note that
                          in the mesh construction phase, the second argument indicates that the
                          nodes with prescribed boundary conditions (here boundary nodes) are
                          eliminates from the list of equations. This is recommended when
                          iterative methods are used.
                          
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>#include "OFELI.h"
#include "Laplace.h"
using namespace OFELI;
                          
int main(int argc, char *argv[])
{
   Mesh ms(argv[1],true);</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          
                          <li><SPAN class=TEXT>
                          We instantiate the matrix as a sparse matrix (instance of
                          <a href="../html/classOFELI_1_1SpMatrix.html">SpMatrix</a>) and
                          the vectors <span class=VAR>b</span>, <span class=VAR>x</span>,
                          <span class=VAR>bc</span> and <span class=VAR>f</span>. Here the
                          vectors <span class=VAR>b</span> and <span class=VAR>x</span>
                          stand for the right-hand side and the solution of the system. They
                          must be dimensioned as the total number of equations (prescribed
                          degrees of freedom are removed). The vectors <span class=VAR>bc</span>
                          and <span class=VAR>f</span> stand respectively for the vector
                          containing imposed values at nodes and the one containing the source
                          (right-hand side of the PDE). Theses vectors are constructed using the
                          <a href="../html/classOFELI_1_1Mesh.html">Mesh</a> instance. To
                          initialize <span class=VAR>f</span> we use a regular expression.
                          The vector <span class=VAR>bc</span> is set to zero since we impose
                          homogeneous Dirichlet boundary conditions.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   SpMatrix&lt;double&gt; A(ms);
   Vect&lt;double&gt; b(ms.getNbEq()), x(ms.getNbEq()), bc(ms), f(ms);
   f = "exp(-20*(x*x+y*y))";
   bc = 0;</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          
                          <li><SPAN class=TEXT>
                          To construct the finite element equations, we construct a loop over elements,
                          instantiate for each element an instance of class
                          <a href="../html/classOFELI_1_1Laplace2DT3.html">Laplace2DT3</a></span>
                          that deals with the 2-D Laplace equation using P<sub>1</sub>--elements.
                          The member functions <span class=VAR>LHS</span> and <span class=VAR>BodyRHS</span>
                          compute the left and right-hand sides of the element equation. The function
                          <span class=VAR>updateBC</span> adds the contribution of the boundary
                          condition to the right-hand side. Note that this is actually not
                          necessary here since we enforce the value 0. We next assemble left and right-hand
                          sides into the global matrix and right-hand side vector.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   MeshElements(ms) {
      Laplace2DT3 eq(theElement);
      eq.LHS();
      eq.BodyRHS(f);
      eq.updateBC(bc);
      eq.ElementAssembly(A);
      eq.ElementAssembly(b);
   }</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          
                          <li><SPAN class=TEXT>To solve the linear system, we use an instance of
                          class <a href="../html/classOFELI_1_1LinearSolver.html">LinearSolver</a></span>
                          where some parameters are provided. Here we assign at maximum 1000
                          iterations, a tolerance of 1.e-8 as convergence criterium and no verbosity.
                          We next solve the linear system by using the Conjugate Gradient method
                          with the Diagonal preconditioner. This member function returns the
                          number of performed iterations.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   LinearSolver&lt;double&gt; ls(1000,1.e-8,0);
   int nb_it = ls.solve(A,b,x,CG_SOLVER,DIAG_PREC);
   cout &lt;&lt; "Number of iterations: " &lt;&lt; nb_it &lt;&lt; endl;</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          
                          <li><SPAN class=TEXT>To end we construct the solution vector by
                          inserting the prescribed values. This is useful for any
                          post-processing purposes.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   Vect&lt;double&gt; u(ms);
   u.insertBC(ms,x,bc);
   return 0;
}</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          </ul></p>

                          <p><table align="center" border="2" cellpadding="2" cellspacing="0" >
                          <tr>
                          <td align="center" width="35"><a href="ls_demo2.html"><img src="../im/backward.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="ode_demo1.html"><img src="../im/forward.gif" border="0"></a></td>
                          </tr>
                          </table>
                        </div>
                     </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.flexslider-min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.countTo.js"></script>
    <script src="js/ofeli-main.js"></script>

  </body>
</html>