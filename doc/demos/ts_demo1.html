<!DOCTYPE HTML>
<html>
  <script src="http://www.w3schools.com/lib/w3data.js"></script>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="ofeli package" />
    <meta name="keywords" content="Modelling, numerical simulation, scientific computing, ofeli" />
    <title>ofeli library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <link rel="icon" type="image/png" sizes="10x10" href="../im/r.jpg" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-59742926-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="../im/ofeli.png">
    <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">

    <link rel="stylesheet" href="../doxygen.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/flexslider.css">
    <link rel="stylesheet" href="../fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/ofeli-style.css">
    <link rel="stylesheet" href="../css/doc.css">

<!--    Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
      <script src="js/respond.min.js"></script>
      <![endif]-->
  </head>

  <body>
    <div id="ofeli-page">
      <div class="container-wrap">
        <aside id="ofeli-aside" role="complementary" class="border js-fullheight">
          <div class="text-center">
            <a href="../index.html">
              <div class="logo-ofeli-img" style="background-image: url(../im/ofeli.png); background-size: 110%;"></div>
            </a>
            <span class="position"><b>Mathematical Modelling<br> and Numerical Simulation</b></span>
          </div>
          <div>
            <ul>
                <li class="active"><a href="../index.html">OFELI Documentation</a></li>
                <li class="active"><a href="../html/classes.html">Classes in OFELI</a></li>
                <li class="active"><a href="../fformats.html">File Formats</span></a></li>
                <li class="active"><a href="../extlib.html">External Libraries</span></a></li>
                <li class="active"><a href="../citing.html">Citing OFELI</span></a></li>
                <li class="active"><a href="../download.html">Download and Installation</a></li>
                <li class="active"><a href="../presentations.html">Presentations</a></li>
                <li class="active"><a href="../copyright.html">License</a></li>
                <li class="active"><a href="mailto:rachid.touzani@uca.fr">Contact</a></li>
            </ul>
        </div>

        <a href="rita.html"><center><img src="../im/rita.png" width="90"></center></a>

<!--      Search Google -->
          <center>
            <form method=GET action="http://www.google.com/search">
              <table bgcolor="#FFFFFF">
                <tr>
                  <td><a href=" http://www.google.com/">
                    <img src="http://www.google.com/logos/Logo_40wht.gif" border="0" alt="Google" align="absmiddle"></a> 
                    <input TYPE=TEXT name=q size=31 maxlength=255 value="">
                    <input type=hidden name=hl value="en">
                    <input type=submit name=btnG value="Search">
                  </td>
                </tr>
              </table>
            </form>
          </center>
 <!--     Search Google -->
 
          <div class="ofeli-footer">
            <p><small>&copy; Copyright <script>document.write(new Date().getFullYear());</script> All rights reserved</small>
            </p>
          </div>
        </aside>
        <div id="ofeli-main">
          <section class="ofeli-start" data-section="home">
            <div class="ofeli-narrow-content">
              <div class="row">
                <div class="col-md-12">
                  <div class="row row-bottom-padded-sm animate-box" data-animate-effect="fadeInLeft">
                    <div class="col-md-12">
                      <div class="start-desc">
                        <h1 class="first-ofeli-heading"></h1>
                        <div id="cc">

                          &nbsp;
                          <p>
                           <h2>Demo: Class TimeStepping: Solution of the time dependent heat equation</h2>
                          
                          <p><table border="2" cellpadding="2" cellspacing="0" >
                          <tr>
                          <td align="center" width="35"><a href="ode_demo4.html"><img src="../im/backward.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="ts_demo2.html"><img src="../im/forward.gif" border="0"></a></td>
                          </tr>
                          </table></p>
                          
                          <p>
                          <SPAN class=TEXT>
                          We present a program to solve the time dependent 2-D heat equation using
                          the P<sub>1</sub> finite element method for space discretization and
                          one of the available time integration schemes for time discretization.
                          To validate the code, we test the exact solution
                          <pre><font color="blue" size=3>   u(x,y) = exp(-t)*exp(x+y)</font></pre>
                          This gives as a source term, in the case where all coefficients are
                          equal to 1:
                          <pre><font color="blue" size=3>   f(x,y) = -3*exp(-t)*exp(x+y)</font></pre>
                          
                          <ul type=square>
                          <li><SPAN class=TEXT>We start, as usual, by including the main header
                          file of the library, and the header for thermal problems.
                          The program has, as argument the mesh file and the time step.
                          We construct a <a href="../html/classOFELI_1_1Mesh.html">Mesh</a>
                          instance with the flag that enables eliminating imposed boundary conditions.
                          Note that the final time value is also set by using the OFELI global
                          variable <span class=VAR>theFinalTime</span>.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>#include "OFELI.h"
#include "Therm.h"
using namespace OFELI;
                          
int main(int argc, char *argv[])
{
   theFinalTime = 1.;
   Mesh ms(argv[1],true);
   theTimeStep = atof(argv[2]);</font></pre>
                          </td></tr></table></p>
                          
                          <li><SPAN class=TEXT>We declare the vectors <span class=VAR>u</span>, <span class=VAR>f</span>
                          and <span class=VAR>bc</span> that are respectively the solution
                          vector, the vector containing the source, and the vector containing
                          imposed boundary values. We then introduce the initial condition by
                          assigning the corresponding algebraic expression to the solution vector.<br>
                          
                          We construct an instance of class
                          <a href="../html/classOFELI_1_1DC2DT3.html">DC2DT3</a> using
                          the <a href="../html/classOFELI_1_1Mesh.html">Mesh</a> instance and
                          choose the terms of the equation. Here the equation contains the
                          (consistent) capacity, the diffusion and the source terms.<br>
                          
                          We can then declare the time integration scheme by instantiating the class
                          <a href="../html/classOFELI_1_1TimeStepping.html">TimeStepping</a>. Clearly, the
                          backward (implicit) Euler scheme is used. To this instance, we
                          transmit the equation reference and set initial solution vector. Note
                          that the solution will be stored in this vector. We also choose the conjugate
                          gradient method preconditioned by the diagonal ILU preconditioner.
                          </span></p>
                          
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   Vect&lt;double&gt; u(ms), f(ms), bc(ms);
   u.set("exp(x+y)");
                          
   DC2DT3 eq(ms);
   eq.setTerms(CAPACITY|DIFFUSION|SOURCE);
                          
   TimeStepping ts(BACKWARD_EULER,theTimeStep,theFinalTime);
   ts.setPDE(eq);
   ts.setInitial(u);
   ts.setLinearSolver(CG_SOLVER,DILU_PREC);</font></pre>
                          </td></tr></table></p>
                          
                          <li><SPAN class=TEXT>We can now loop over time steps. For each time
                          step, we give the source terms, which is time dependent and transfer
                          it to the instance of <a href="../html/classOFELI_1_1TimeStepping.html">TimeStepping</a>.
                          The same treatment is realized for the Dirichlet boundary condition. Finally
                          we run the time step. Note that the vector <span class=VAR>u</span> contains
                          now the solution at the current time.
                          </span></p>
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   TimeLoop {
      f.setTime(theTime);
      f.set("-3*exp(-t)*exp(x+y)");
      ts.setRHS(f);                    
      bc.setTime(theTime);
      bc.setNodeBC(1,"exp(-t)*exp(x+y)");
      ts.setBC(bc);
      ts.runOneTimeStep();
   }</font></pre>
                          </td></tr></table></p>
                          
                          <li><SPAN class=TEXT>We end by printing the
                          <a href="../html/classOFELI_1_1TimeStepping.html">TimeStepping</a>
                          instance information. To compute error, we consider the vector <span
                          class=VAR>U</span> containing the exact solution at nodes, and compute
                          an error norm.
                          </span></p>
                          
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   cout &lt;&lt; ts;
   Vect&lt;double> U(ms,"u_ex",theFinalTime);
   U.set("exp(-1)*exp(x+y)");
   cout &lt;&lt; "Error in L2-Norm: " &lt;&lt; (u-U).getWNorm2() &lt;&lt; endl;
   return 0;
}</font></pre>
                          </td></tr></table>
                          </ul>
                          
                          <p><table align="center" border="2" cellpadding="2" cellspacing="0" >
                          <tr>
                          <td align="center" width="35"><a href="ode_demo4.html"><img src="../im/backward.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="ts_demo2.html"><img src="../im/forward.gif" border="0"></a></td>
                          </tr>
                          </table>
                        </div>
                     </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.flexslider-min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.countTo.js"></script>
    <script src="js/ofeli-main.js"></script>

  </body>
</html>