<!-- XHTML 1.0 Strict -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<meta name="author" content="Rachid Touzani" />
<meta name="keywords" content=" css, dropdowns, dropdown menu, drop-down, menu, navigation, nav, horizontal, vertical left-to-right, vertical right-to-left, horizontal linear, horizontal upwards, cross browser, internet explorer, ie, firefox, safari, opera, browser, lwis" />
<meta name="description" content="Clean, standards-friendly, modular framework for dropdown menus" />
<link href="../css/dropdown.vertical.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../css/default.ultimate.css" media="screen" rel="stylesheet" type="text/css" />

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>OFELI Demo: 1-D transport equation</title>
<link rel="stylesheet" type="text/css" href="../doxygen.css" />
<link rel="stylesheet" type="text/css" href="../tabs.css"  />
</head>

<body bgcolor="#FFFFFF" link="#FF0000" vlink="#FF00FF" alink="#FF00FF">
<p align="center"><a href="../index.html"><img src="../im/ofeli.gif" width="150" border="0"></a></p>

<center>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript"> 
     google.load('search', '1', {language : 'en', style : google.loader.themes.SHINY});
     google.setOnLoadCallback(function() {
        var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
        '012396140824982761142:-qrywxcfi_o', customSearchOptions);
        customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
        customSearchControl.draw('cse');
     }, true);
   </script>
   <style type="text/css">
     .gsc-control-cse {
     font-family: Verdana, sans-serif;
     border-color: #DAE0E5;
     background-color: #DAE0E5;
   }
   .gsc-control-cse .gsc-table-result { font-family: Verdana, sans-serif; }
   input.gsc-input { border-color: #B6BEC5; }
   input.gsc-search-button {
     border-color: #B6BEC5;
     background-color: #D0D1D4;
   }
   .gsc-tabHeader.gsc-tabhInactive {
     border-color: #999999;
     background-color: #EEEEEE;
   }
   .gsc-tabHeader.gsc-tabhActive {
     border-color: #999999;
     background-color: #999999;
   }
   .gsc-tabsArea { border-color: #999999; }
   .gsc-webResult.gsc-result,
   .gsc-results .gsc-imageResult {
     border-color: #FFFFFF;
     background-color: #FFFFFF;
   }
   .gsc-webResult.gsc-result:hover,
   .gsc-imageResult:hover {
     border-color: #D2D6DC;
     background-color: #EDEDED;
   }
   .gsc-webResult.gsc-result.gsc-promotion:hover {
     border-color: #D2D6DC;
     background-color: #EDEDED;
   }
   .gs-webResult.gs-result a.gs-title:link,
   .gs-webResult.gs-result a.gs-title:link b,
   .gs-imageResult a.gs-title:link,
   .gs-imageResult a.gs-title:link b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:visited,
   .gs-webResult.gs-result a.gs-title:visited b,
   .gs-imageResult a.gs-title:visited,
   .gs-imageResult a.gs-title:visited b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:hover,
   .gs-webResult.gs-result a.gs-title:hover b,
   .gs-imageResult a.gs-title:hover,
   .gs-imageResult a.gs-title:hover b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:active,
   .gs-webResult.gs-result a.gs-title:active b,
   .gs-imageResult a.gs-title:active,
   .gs-imageResult a.gs-title:active b { color: #0568CD; }
   .gsc-cursor-page { color: #0568CD; }
   a.gsc-trailing-more-results:link { color: #0568CD; }
   .gs-webResult .gs-snippet,
   .gs-imageResult .gs-snippet,
   .gs-fileFormatType { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl,
   .gs-imageResult div.gs-visibleUrl { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl-short { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl-short { display: none; }
   .gs-webResult div.gs-visibleUrl-long { display: block; }
   .gs-promotion div.gs-visibleUrl-short { display: none; }
   .gs-promotion div.gs-visibleUrl-long { display: block; }
   .gsc-cursor-box { border-color: #FFFFFF; }
   .gsc-results .gsc-cursor-box .gsc-cursor-page {
      border-color: #999999;
      background-color: #FFFFFF;
      color: #0568CD;
   }
   .gsc-results .gsc-cursor-box .gsc-cursor-current-page {
      border-color: #999999;
      background-color: #999999;
      color: #0568CD;
   }
   .gsc-webResult.gsc-result.gsc-promotion {
      border-color: #D2D6DC;
      background-color: #D0D1D4;
   }
   .gsc-completion-title { color: #0568CD; }
   .gsc-completion-snippet { color: #5F6A73; }
   .gs-promotion a.gs-title:link,
   .gs-promotion a.gs-title:link *,
   .gs-promotion .gs-snippet a:link { color: #0066CC; }
   .gs-promotion a.gs-title:visited,
   .gs-promotion a.gs-title:visited *,
   .gs-promotion .gs-snippet a:visited { color: #0066CC; }
   .gs-promotion a.gs-title:hover,
   .gs-promotion a.gs-title:hover *,
   .gs-promotion .gs-snippet a:hover { color: #0066CC; }
   .gs-promotion a.gs-title:active,
   .gs-promotion a.gs-title:active *,
   .gs-promotion .gs-snippet a:active { color: #0066CC; }
   .gs-promotion .gs-snippet,
   .gs-promotion .gs-title .gs-promotion-title-right,
   .gs-promotion .gs-title .gs-promotion-title-right *  { color: #333333; }
   .gs-promotion .gs-visibleUrl,
   .gs-promotion .gs-visibleUrl-short { color: #5F6A73; }
   </style>
</center>
</p>

<div id="mainmenu">
   <div class="text">
     <div class="tabs">
         <ul class="tablist">
           <li><a href="../index.html"><span>Home</span></a></li>
           <li><a href="../installation.html"><span>Installation</span></a></li>
           <li><a href="../html/index.html"><span>Class Documentation</span></a></li>
           <li><a href="../citing.html"><span>Citing OFELI</span></a></li>
           <li><a href="../fformats.html"><span>File Formats</span></a></li>
           <li class="current"><a href="../demos.html"><span>Demo Codes</span></a></li>
           <li><a href="../extlib.html"><span>External Libraries</span></a></li>
         </ul>
      </div>
   </div>
</div>

&nbsp;
<p><table border="2" cellpadding="2" cellspacing="0" >
<tr>
<td align="center" width="35"><a href="heat.html"><img src="../im/backward.gif" border="0"></a></td>
<td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
<td align="center" width="35"><a href="laplace_demo1.html"><img src="../im/forward.gif" border="0"></a></td>
</tr>
</table>

<p>
<h2>A 1-D linear transport equation</h2>

<p>
<SPAN class=TEXT>This code illustrates the numerical solution of a 1-D
linear transport equation using a finite difference scheme.
</SPAN>

<ul type="square">
   <li><SPAN class=TEXT>For conciseness, we skip the description of
   the heading of the main program. This has been presented
   previously. We assign values of the length of the interval and the
  velocity.
  We also declare a file where the solution is stored</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   const double L = 10., c = 4.;
   ofstream pf("output.dat");</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We now declare discretization data. <span class=TT>nx</span>
is the number of grid sub-intervals and <span class=TT>h</span> is the grid size. 
The time step is obtained as a program argument <span
   class=TT>OFELI</span> and the final time is set to <span
   class=TT>1</span>. These two parameters are assigned to global
   variables in <span class=LOGO>OFELI</span>.</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   size_t nx = atoi(argv[1]);
   double h = L/double(nx);
   theTimeStep = atof(argv[2]);
   theFinalTime = 1.;
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We compute the CFL of the numerical scheme and
then declare vectors <span class=TT>x</span>, <span class=TT>u</span> and
<span class=TT>v</span> which are respectively the vector of grid
point coordinates, solution at previous time step and solution at
actual one. We then define grid as a uniform one.
</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   double cfl = c*theTimeStep/h;
   Vect&lt;double&gt; x, u(nx+1), v(nx+1);
   x.setUniform(0.,L,nx+1);</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We define the initial condition as a Gaussian function:</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   u.set("exp(-20*(x-2)^2)",x);</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We set the time loop and implement the upwind finite difference scheme to compute
the solution at current time step:</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   TimeLoop {
      v(1) = u(1) - cfl*(0.5*u(2)-cfl*(u(2)-2*u(1)));
      for (size_t i=2; i &lt;=nx+1; i++)
         v(i) = u(i) - cfl*(0.5*(u(i+1)-u(i-1))-cfl*(u(i+1)-2*u(i)+u(i-1)));
      u = v;
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We store solution at current time step into the dedicated file and close the time loop.</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      for (size_t i=1; i&lt;=nx+1; i++)
         pf &lt;&lt; x(i) &lt;&lt; "   " &lt;&lt; u(i) &lt;&lt; endl;
      pf &lt;&lt; endl;
   }
</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We finally print some information:</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   cout &lt;&lt; "Number of grid intervals: " &lt;&lt; nx &lt;&lt; endl;
   cout &lt;&lt; "Time step:                " &lt;&lt; theTimeStep &lt;&lt; endl;
   cout &lt;&lt; "CFL:                      " &lt;&lt; cfl &lt;&lt; endl;
   return 0;
</font></pre>
</td></tr></table></p>
</ul>

&nbsp;
<p><table align="center" border="2" cellpadding="2" cellspacing="0" >
<tr>
<td align="center" width="35"><a href="heat.html"><img src="../im/backward.gif" border="0"></a></td>
<td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
<td align="center" width="35"><a href="laplace_demo1.html"><img src="../im/forward.gif" border="0"></a></td>
</tr>
</table>

&nbsp;
<div id="foot_bar">
        Copyright &copy; 1998-2022 Rachid Touzani&nbsp;
</div>

</body>
</html>
