<!DOCTYPE HTML>
<html>
  <script src="http://www.w3schools.com/lib/w3data.js"></script>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="ofeli package" />
    <meta name="keywords" content="Modelling, numerical simulation, scientific computing, ofeli" />
    <title>ofeli library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <link rel="icon" type="image/png" sizes="10x10" href="../im/r.jpg" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-59742926-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="../im/ofeli.png">
    <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">

    <link rel="stylesheet" href="../css/doxygen.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/flexslider.css">
    <link rel="stylesheet" href="../fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/ofeli-style.css">
    <link rel="stylesheet" href="../css/doc.css">

<!--    Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
      <script src="js/respond.min.js"></script>
      <![endif]-->
  </head>

  <body>
    <div id="ofeli-page">
      <div class="container-wrap">
        <aside id="ofeli-aside" role="complementary" class="border js-fullheight">
          <div class="text-center">
            <a href="../index.html">
              <div class="logo-ofeli-img" style="background-image: url(../im/ofeli.png); background-size: 110%;"></div>
            </a>
            <span class="position"><b>Mathematical Modelling<br> and Numerical Simulation</b></span>
          </div>
          <div>
            <div>
              <ul>
                  <li class="active"><a href="../index.html">OFELI Documentation</a></li>
                  <li class="active"><a href="../html/classes.html">Classes in OFELI</a></li>
                  <li class="active"><a href="../fformats.html">File Formats</span></a></li>
                  <li class="active"><a href="../extlib.html">External Libraries</span></a></li>
                  <li class="active"><a href="../citing.html">Citing OFELI</span></a></li>
                  <li class="active"><a href="../download.html">Download and Installation</a></li>
                  <li class="active"><a href="../news.html">News</span></a></li>
                  <li class="active"><a href="../presentations.html">Presentations</a></li>
                  <li class="active"><a href="../copyright.html">License</a></li>
                  <li class="active"><a href="mailto:rachid.touzani@uca.fr">Contact</a></li>
              </ul>
          </div>
  
          <a href="rita.html"><center><img src="../im/rita.png" width="90"></center></a>
  
<!--      Search Google -->
          <center>
            <form method=GET action="http://www.google.com/search">
              <table bgcolor="#FFFFFF">
                <tr>
                  <td><a href=" http://www.google.com/">
                    <img src="http://www.google.com/logos/Logo_40wht.gif" border="0" alt="Google" align="absmiddle"></a> 
                    <input TYPE=TEXT name=q size=31 maxlength=255 value="">
                    <input type=hidden name=hl value="en">
                    <input type=submit name=btnG value="Search">
                  </td>
                </tr>
              </table>
            </form>
          </center>
 <!--     Search Google -->
 
          <div class="ofeli-footer">
            <p><small>&copy; Copyright <script>document.write(new Date().getFullYear());</script> All rights reserved</small>
            </p>
          </div>
        </aside>
        <div id="ofeli-main">
          <section class="ofeli-start" data-section="home">
            <div class="ofeli-narrow-content">
              <div class="row">
                <div class="col-md-12">
                  <div class="row row-bottom-padded-sm animate-box" data-animate-effect="fadeInLeft">
                    <div class="col-md-12">
                      <div class="start-desc">
                        <h1 class="first-ofeli-heading"></h1>
                        <div id="cc">
                           &nbsp;
                           <p><table border="2" cellpadding="2" cellspacing="0" >
                           <tr>
                           <td align="center" width="35"><a href="heat.html"><img src="../im/backward.gif" border="0"></a></td>
                           <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                           <td align="center" width="35"><a href="laplace_demo1.html"><img src="../im/forward.gif" border="0"></a></td>
                           </tr>
                           </table><br>
                          <font color="#203F5B" size="4" face="verdana,Helvetica">
                          <p><b>Demo: A 1-D linear transport equation</b></font></p>
                          <p>
                           <SPAN class=TEXT>This code illustrates the numerical solution of a 1-D
                           linear transport equation using a finite difference scheme.
                           </SPAN>
                           
                           <ul type="square">
                              <li><SPAN class=TEXT>For conciseness, we skip the description of
                              the heading of the main program. This has been presented
                              previously. We assign values of the length of the interval and the velocity.
                              We also declare a file where the solution is stored</span><br>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>   const double L = 10., c = 4.;
   ofstream pf("output.dat");</font></pre>
                           </td></tr></table></p>
                           <li><SPAN class=TEXT>We now declare discretization data. <span class=TT>nx</span>
                           is the number of grid sub-intervals and <span class=TT>h</span> is the grid size. 
                           The time step is obtained as a program argument <span class=logo>OFELI</span> and the final time is set to 
                           <span class=TT>1</span>. These two parameters are assigned to global variables in <span class=logo>OFELI</span>.</span><br>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>   size_t nx = atoi(argv[1]);
   double h = L/double(nx);
   theTimeStep = atof(argv[2]);
   theFinalTime = 1.;</font></pre>
                           </td></tr></table></p>
                           <li><SPAN class=TEXT>We compute the CFL of the numerical scheme and
                           then declare vectors <span class=TT>x</span>, <span class=TT>u</span> and
                           <span class=TT>v</span> which are respectively the vector of grid
                           point coordinates, solution at previous time step and solution at
                           actual one. We then define grid as a uniform one.
                           </span><br>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>   double cfl = c*theTimeStep/h;
   Vect&lt;double&gt; x, u(nx+1), v(nx+1);
   x.setUniform(0.,L,nx+1);</font></pre>
                           </td></tr></table></p>
                           <li><SPAN class=TEXT>We define the initial condition as a Gaussian function:</span></br>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>   u.set("exp(-20*(x-2)^2)",x);</font></pre>
                           </td></tr></table></p>
                           <li><SPAN class=TEXT>We set the time loop and implement the upwind finite difference scheme to compute
                           the solution at current time step:</span></br>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>   TimeLoop {
      v(1) = u(1) - cfl*(0.5*u(2)-cfl*(u(2)-2*u(1)));
      for (size_t i=2; i &lt;=nx+1; i++)
         v(i) = u(i) - cfl*(0.5*(u(i+1)-u(i-1))-cfl*(u(i+1)-2*u(i)+u(i-1)));
      u = v;</font></pre>
                           </td></tr></table></p>
                           <li><SPAN class=TEXT>We store solution at current time step into the dedicated file and close the time loop.</span></br>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>      for (size_t i=1; i&lt;=nx+1; i++)
         pf &lt;&lt; x(i) &lt;&lt; "   " &lt;&lt; u(i) &lt;&lt; endl;
      pf &lt;&lt; endl;
   }</font></pre>
                           </td></tr></table></p>
                           <li><SPAN class=TEXT>We finally print some information:</span>
                           <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                           <tr><td>
                           <pre><font color="blue" size=2>   cout &lt;&lt; "Number of grid intervals: " &lt;&lt; nx &lt;&lt; endl;
   cout &lt;&lt; "Time step:                " &lt;&lt; theTimeStep &lt;&lt; endl;
   cout &lt;&lt; "CFL:                      " &lt;&lt; cfl &lt;&lt; endl;
   return 0;</font></pre>
                           </td></tr></table></p>
                           </ul>
                           
                           &nbsp;
                           <p><table align="center" border="2" cellpadding="2" cellspacing="0" >
                           <tr>
                              <td align="center" width="35"><a href="heat.html"><img src="../im/backward.gif" border="0"></a></td>
                              <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                              <td align="center" width="35"><a href="laplace_demo1.html"><img src="../im/forward.gif" border="0"></a></td>
                           </tr>
                           </table>
                        </div>
                     </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.flexslider-min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.countTo.js"></script>
    <script src="js/ofeli-main.js"></script>

  </body>
</html>