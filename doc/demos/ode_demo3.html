<!DOCTYPE HTML>
<html>
  <script src="http://www.w3schools.com/lib/w3data.js"></script>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="ofeli package" />
    <meta name="keywords" content="Modelling, numerical simulation, scientific computing, ofeli" />
    <title>ofeli library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <link rel="icon" type="image/png" sizes="10x10" href="../im/r.jpg" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-59742926-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="../im/ofeli.png">
    <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">

    <link rel="stylesheet" href="../css/doxygen.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/flexslider.css">
    <link rel="stylesheet" href="../fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/ofeli.css">
    <link rel="stylesheet" href="../css/doc.css">

<!--    Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
      <script src="js/respond.min.js"></script>
      <![endif]-->
  </head>

  <body>
    <div id="ofeli-page">
      <div class="container-wrap">
        <aside id="ofeli-aside" role="complementary" class="border js-fullheight">
          <div class="text-center">
            <a href="../index.html">
              <div class="logo-ofeli-img" style="background-image: url(../im/ofeli.png); background-size: 110%;"></div>
            </a>
            <span class="position"><b>Mathematical Modelling<br> and Numerical Simulation</b></span>
          </div>
          <div>
            <ul>
                <li class="active"><a href="../index.html">OFELI Documentation</a></li>
                <li class="active"><a href="../html/classes.html">Classes in OFELI</a></li>
                <li class="active"><a href="../fformats.html">File Formats</span></a></li>
                <li class="active"><a href="../extlib.html">External Libraries</span></a></li>
                <li class="active"><a href="../citing.html">Citing OFELI</span></a></li>
                <li class="active"><a href="../download.html">Download and Installation</a></li>
                <li class="active"><a href="../news.html">News</span></a></li>
                <li class="active"><a href="../presentations.html">Presentations</a></li>
                <li class="active"><a href="../copyright.html">License</a></li>
                <li class="active"><a href="mailto:rachid.touzani@uca.fr">Contact</a></li>
            </ul>
          </div>

          <a href="rita.html"><center><img src="../im/rita.png" width="90"></center></a>

          <div class="ofeli-footer">
            <p><small>&copy; Copyright <script>document.write(new Date().getFullYear());</script> All rights reserved</small>
            </p>
          </div>
        </aside>
        <div id="ofeli-main">
          <section class="ofeli-start" data-section="home">
            <div class="ofeli-narrow-content">
              <div class="row">
                <div class="col-md-12">
                  <div class="row row-bottom-padded-sm animate-box" data-animate-effect="fadeInLeft">
                    <div class="col-md-12">
                      <div class="start-desc">
                        <h1 class="first-ofeli-heading"></h1>
                        <div id="cc">

                          &nbsp;
                          <p>
                          <h2>Demo: Class ODESolver: A differential system of equations</h2>
                          
                          <p><table border="2" cellpadding="2" cellspacing="0" >
                          <tr>
                          <td align="center" width="35"><a href="ls_demo2.html"><img src="../im/backward.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="ode_demo4.html"><img src="../im/forward.gif" border="0"></a></td>
                          </tr>
                          </table></p>
                          
                          <p>
                          <SPAN class=TEXT>
                          We present a program to solve by a numerical scheme a system of
                          first-order linear differential equations of the form
                          <pre><font color="blue" size=2>                  A<sub>1</sub>y' + A<sub>0</sub>y = f</font></pre>
                          where the matrices <span class="TT">A<sub>0</sub></span> and <span class="TT">A<sub>1</sub></span> are
                          <pre><font color="blue" size=2>        | 0  -1 |            | 1  0 |       |      0       |
   A0 = |       |,      A1 = |      |, f =  |              |
        | 1  -1 |            | 0  1 |       | 3(t-1)exp(t) |</font></pre>
                          With adapted initial conditions, the solution is given by
                          <pre><font color="blue" size=2>        y<sub>1</sub>(t) = t*exp(-t), y<sub>2</sub>(t) = (1-t)*exp(-t)</font></pre>
                          
                          <ul type=square>
                            <li><SPAN class=TEXT>After initializing the global variables <span
                            class="VAR">theFinalTime</span> and <span
                            class="VAR">theTimeStep</span>, we declare an instance of class 
                            <a href="../html/classOFELI_1_1ODESolver.html">ODESolver</a></span>,
                            where we have chosen the BDF2 scheme (2nd order Backward Difference
                            Formula), and set the number of equations to <span
                            class"VAR">2</span>.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   ODESolver ode(BDF2,theTimeStep,theFinalTime,2);</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          
                          <li><SPAN class=TEXT>
                          Once the instance created, we declare the matrices (as dense matrices)
                          and send them to the class. Note that since their pointers are stored,
                          their contents can be modified thrghout the time stepping. Next we
                          declare the necessary vectors: the solution and the right-hand side
                          vector.
                          We give the initial condition using the member function <span class="VAR">setInitial</span>,
                          the right-hand side using <span class="VAR">setRHS</span> and, since
                          we deal with a two-step method, an initial right-hand side. Note that
                          this is not mandatory but improves the accuracy.
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   DMatrix&lt;double&gt; A0(2,2), A1(2,2);
   ode.setMatrices(A0,A1);
   Vect&lt;double&gt; y(2), f(2);
   y(1) = 0; y(2) = 1;
   f(1) = 0; f(2) = -3;
   ode.setInitial(y);
   ode.setRHS(f);
   ode.setInitialRHS(f);</font></pre>
                          </td></tr></table>
                          </SPAN></p>
                          
                          <li><SPAN class=TEXT>Since the system of equations as well as data are
                          given, in this example, by numerical values (rather than by algebraic
                          expressions), we explicitly use a loop over time steps, where at each
                          time step, the matrices, as well as the right-hand side are updated.
                          Note that this is necessary even if the matrices are constant, since
                          they are fatorized each time step.
                          
                          <p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
                          <tr><td>
                          <pre><font color="blue" size=2>   TimeLoop {
      A1 = 1;
      A0(1,1) = 0; A0(1,2) = -1; A0(2,1) = 1; A0(2,2) = -1;
      f(1) = 0; f(2) = 3*(theTime-1)*exp(-theTime);
      ode.runOneTimeStep();
   }</font></pre>
                          </td></tr></table>
                          </SPAN></p> 
                          </SPAN></p>
                          <p><table align="center" border="2" cellpadding="2" cellspacing="0" >
                          <tr>
                          <td align="center" width="35"><a href="ls_demo2.html"><img src="../im/backward.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="../demos.html"><img src="../im/top.gif" border="0"></a></td>
                          <td align="center" width="35"><a href="ode_demo4.html"><img src="../im/forward.gif" border="0"></a></td>
                          </tr>
                          </table>
                        </div>
                     </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.flexslider-min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.countTo.js"></script>
    <script src="js/ofeli-main.js"></script>

  </body>
</html>